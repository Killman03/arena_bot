# üö® –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "–î–æ—Å—Ç—É–ø –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω" –≤ Health Connect

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

**–û—à–∏–±–∫–∞:** "–î–æ—Å—Ç—É–ø –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏" –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å Health Connect"

**–ü—Ä–∏—á–∏–Ω—ã:**
1. ‚ùå –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Google Cloud Console
2. ‚ùå –ù–µ –≤–∫–ª—é—á–µ–Ω—ã –Ω—É–∂–Ω—ã–µ API
3. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ OAuth credentials
4. ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π redirect URI
5. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª `.env`

## üõ†Ô∏è –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Cloud Console

#### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –ó–∞–ø–æ–º–Ω–∏—Ç–µ **Project ID**

#### 1.2 –í–∫–ª—é—á–µ–Ω–∏–µ API
–í —Ä–∞–∑–¥–µ–ª–µ **"APIs & Services" ‚Üí "Library"** –≤–∫–ª—é—á–∏—Ç–µ:
- ‚úÖ **Google Fit API**
- ‚úÖ **Google Drive API** 
- ‚úÖ **Google+ API** (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

#### 1.3 –°–æ–∑–¥–∞–Ω–∏–µ OAuth 2.0 credentials
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"APIs & Services" ‚Üí "Credentials"**
2. –ù–∞–∂–º–∏—Ç–µ **"Create Credentials" ‚Üí "OAuth 2.0 Client IDs"**
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø: **"Web application"**
4. –î–æ–±–∞–≤—å—Ç–µ **Authorized redirect URIs**:
   ```
   http://localhost:8000/auth/google/callback
   https://yourdomain.com/auth/google/callback  # –µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ–º–µ–Ω
   ```
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ **Client ID** –∏ **Client Secret**

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### 2.1 –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ .env
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä:
copy env.example .env
```

#### 2.2 –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Google credentials
–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:
```env
# Google Fit Integration
GOOGLE_CLIENT_ID=your_actual_client_id_here
GOOGLE_CLIENT_SECRET=your_actual_client_secret_here
GOOGLE_REDIRECT_URI=http://localhost:8000/auth/google/callback
```

**–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ `your_actual_client_id_here` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π Client ID –∏–∑ Google Cloud Console

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env` —Ñ–∞–π–ª–∞ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C)
# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
python -m app.bot
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
python -c "
from app.config import settings
print(f'Google Client ID: {settings.google_client_id}')
print(f'Google Client Secret: {settings.google_client_secret[:10]}...')
print(f'Redirect URI: {settings.google_redirect_uri}')
"
```

### –¢–µ—Å—Ç 2: –¢–µ—Å—Ç Health Connect —Å–µ—Ä–≤–∏—Å–∞
```bash
python test_health_connect.py
```

## üö® –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞ 1: "No module named 'aiohttp'"
```bash
pip install aiohttp
```

### –û—à–∏–±–∫–∞ 2: "Invalid client_id"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Client ID –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏ ID –ø–æ–ª–Ω–æ—Å—Ç—å—é

### –û—à–∏–±–∫–∞ 3: "Redirect URI mismatch"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ redirect URI –≤ Google Cloud Console
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URI –≤ `.env` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º

### –û—à–∏–±–∫–∞ 4: "API not enabled"
- –í–∫–ª—é—á–∏—Ç–µ Google Fit API –≤ Google Cloud Console
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è

## üì± –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ

### Android 14+ (Health Connect)
1. –û—Ç–∫—Ä–æ–π—Ç–µ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ó–¥–æ—Ä–æ–≤—å–µ**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏–¥–∏—Ç–µ **Health Connect**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –Ω—É–∂–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã (–µ—Å–ª–∏ Health Connect –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
1. **Google Fit** - –ø—Ä—è–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
2. **Google Drive** - —á–µ—Ä–µ–∑ Health Sync

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –±–æ—Ç–∞
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
python -m app.bot --log-level DEBUG
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Google Cloud Console
1. **APIs & Services ‚Üí Dashboard** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª—é—á–µ–Ω–Ω—ã–µ API
2. **APIs & Services ‚Üí Credentials** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ OAuth credentials
3. **APIs & Services ‚Üí OAuth consent screen** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚úÖ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ –í –º–µ–Ω—é "üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏" –≤–∏–¥–Ω–æ Health Connect
3. ‚úÖ –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å Health Connect" –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Google –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
4. ‚úÖ –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –∫–æ–¥ –¥–ª—è –±–æ—Ç–∞
5. ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/health_connect_auth –ö–û–î` —Ä–∞–±–æ—Ç–∞–µ—Ç

## üÜò –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**
2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Cloud Console –¥–æ—Å—Ç—É–ø–µ–Ω**
3. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä**
4. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞**
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å**

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è:
1. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –≤—Å–µ —à–∞–≥–∏
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º

---

**–ü–æ–º–Ω–∏—Ç–µ:** Health Connect —Ç—Ä–µ–±—É–µ—Ç Android 14+ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Google Cloud Console!
